\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    
    \usepackage{iftex}
    \ifPDFTeX
    	\usepackage[T1]{fontenc}
    	\usepackage{mathpazo}
    \else
    	\usepackage{fontspec}
    \fi

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range
    \makeatletter % fix for old versions of grffile with XeLaTeX
    \@ifpackagelater{grffile}{2019/11/01}
    {
      % Do nothing on new versions
    }
    {
      \def\Gread@@xetex#1{%
        \IfFileExists{"\Gin@base".bb}%
        {\Gread@eps{\Gin@base.bb}}%
        {\Gread@@xetex@aux#1}%
      }
    }
    \makeatother
    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % common color for the border for error outputs.
    \definecolor{outerrorbackground}{HTML}{FFDFDF}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{ROAR\_classification\_test}
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\@namedef{PY@tok@w}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\@namedef{PY@tok@c}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cp}{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\@namedef{PY@tok@k}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kt}{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\@namedef{PY@tok@o}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ow}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@nb}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nf}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@ne}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\@namedef{PY@tok@nv}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@no}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\@namedef{PY@tok@nl}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\@namedef{PY@tok@ni}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\@namedef{PY@tok@na}{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\@namedef{PY@tok@nt}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nd}{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@s}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sd}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@si}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\@namedef{PY@tok@se}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\@namedef{PY@tok@sr}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\@namedef{PY@tok@ss}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sx}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@m}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@gh}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@gu}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\@namedef{PY@tok@gd}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\@namedef{PY@tok@gi}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\@namedef{PY@tok@gr}{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\@namedef{PY@tok@ge}{\let\PY@it=\textit}
\@namedef{PY@tok@gs}{\let\PY@bf=\textbf}
\@namedef{PY@tok@gp}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@go}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\@namedef{PY@tok@gt}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\@namedef{PY@tok@err}{\def\PY@bc##1{{\setlength{\fboxsep}{\string -\fboxrule}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}}
\@namedef{PY@tok@kc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kd}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kr}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@bp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@fm}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@vc}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vg}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vi}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vm}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sa}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sb}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sc}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@dl}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s2}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sh}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s1}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@mb}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mf}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mh}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mi}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@il}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mo}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ch}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cm}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cpf}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@c1}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cs}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb. 
    \makeatletter
        \newbox\Wrappedcontinuationbox 
        \newbox\Wrappedvisiblespacebox 
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}} 
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}} 
        \newcommand*\Wrappedcontinuationindent {3ex } 
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox} 
        % Take advantage of the already applied Pygments mark-up to insert 
        % potential linebreaks for TeX processing. 
        %        {, <, #, %, $, ' and ": go to next line. 
        %        _, }, ^, &, >, - and ~: stay at end of broken line. 
        % Use of \textquotesingle for straight quote. 
        \newcommand*\Wrappedbreaksatspecials {% 
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}% 
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}% 
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}% 
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}% 
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}% 
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}% 
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}% 
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}% 
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}% 
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}% 
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}% 
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}% 
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}% 
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}% 
        } 
        % Some characters . , ; ? ! / are not pygmentized. 
        % This macro makes them "active" and they will insert potential linebreaks 
        \newcommand*\Wrappedbreaksatpunct {% 
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}% 
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}% 
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}% 
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}% 
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}% 
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}% 
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}% 
            \catcode`\.\active
            \catcode`\,\active 
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active 
            \lccode`\~`\~ 	
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%
        
        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active 	
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}
    
    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        {\ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{1}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Testing LLM classifer with UNDP evaluation data}
\PY{c+c1}{\PYZsh{} Promptlayer tracker (https://promptlayer.com/workspace/)}


\PY{k+kn}{from} \PY{n+nn}{langchain} \PY{k+kn}{import} \PY{n}{PromptTemplate}
\PY{k+kn}{from} \PY{n+nn}{langchain}\PY{n+nn}{.}\PY{n+nn}{chat\PYZus{}models} \PY{k+kn}{import} \PY{n}{PromptLayerChatOpenAI}
\PY{k+kn}{from} \PY{n+nn}{langchain}\PY{n+nn}{.}\PY{n+nn}{chains}\PY{n+nn}{.}\PY{n+nn}{mapreduce} \PY{k+kn}{import} \PY{n}{MapReduceChain}
\PY{k+kn}{from} \PY{n+nn}{langchain}\PY{n+nn}{.}\PY{n+nn}{text\PYZus{}splitter} \PY{k+kn}{import} \PY{n}{CharacterTextSplitter}
\PY{k+kn}{from} \PY{n+nn}{langchain}\PY{n+nn}{.}\PY{n+nn}{chains} \PY{k+kn}{import} \PY{n}{ReduceDocumentsChain}\PY{p}{,} \PY{n}{MapReduceDocumentsChain}\PY{p}{,} \PY{n}{StuffDocumentsChain}
\PY{k+kn}{from} \PY{n+nn}{langchain}\PY{n+nn}{.}\PY{n+nn}{chains} \PY{k+kn}{import} \PY{n}{LLMChain}
\PY{k+kn}{from} \PY{n+nn}{langchain}\PY{n+nn}{.}\PY{n+nn}{output\PYZus{}parsers} \PY{k+kn}{import} \PY{n}{CommaSeparatedListOutputParser}
\PY{k+kn}{from} \PY{n+nn}{langchain}\PY{n+nn}{.}\PY{n+nn}{docstore}\PY{n+nn}{.}\PY{n+nn}{document} \PY{k+kn}{import} \PY{n}{Document}
\PY{k+kn}{import} \PY{n+nn}{os}
\PY{k+kn}{import} \PY{n+nn}{promptlayer}
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\PY{k+kn}{import} \PY{n+nn}{openai}


\PY{n}{gpt\PYZus{}model} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{gpt\PYZhy{}4}\PY{l+s+s2}{\PYZdq{}}


\PY{n}{openai\PYZus{}api\PYZus{}key} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Your Key}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{promptlayer\PYZus{}api\PYZus{}key}\PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Your Key}\PY{l+s+s2}{\PYZdq{}}


\PY{c+c1}{\PYZsh{} Set the PromptLayer API key}
\PY{n}{promptlayer}\PY{o}{.}\PY{n}{api\PYZus{}key} \PY{o}{=} \PY{n}{promptlayer\PYZus{}api\PYZus{}key}
\PY{n}{promptlayer}\PY{o}{.}\PY{n}{openai}\PY{o}{.}\PY{n}{api\PYZus{}key} \PY{o}{=} \PY{n}{openai\PYZus{}api\PYZus{}key}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{8}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}Parameters}
\PY{c+c1}{\PYZsh{}Select the csv filename for modelling}
\PY{n}{filename} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{test.csv}\PY{l+s+s2}{\PYZdq{}}
\PY{n}{topic\PYZus{}filename} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Topic.csv}\PY{l+s+s2}{\PYZdq{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{9}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Read data from the Csv file}
\PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{filename}\PY{p}{)}
\PY{n}{captions} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Caption}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}
\PY{n}{doc\PYZus{}captions} \PY{o}{=} \PY{p}{[}\PY{n}{Document}\PY{p}{(}\PY{n}{page\PYZus{}content}\PY{o}{=}\PY{n}{t}\PY{p}{)} \PY{k}{for} \PY{n}{t} \PY{o+ow}{in} \PY{n}{captions}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{10}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Read Existing Topics from CSV}
\PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{topic\PYZus{}filename}\PY{p}{)}
\PY{n}{existing\PYZus{}topics} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Topic}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}

\PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{existing\PYZus{}topics}\PY{p}{)}\PY{o}{!=}\PY{l+m+mi}{1}\PY{p}{:}
    \PY{n}{topics\PYZus{}combined} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{existing\PYZus{}topics}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{str}\PY{p}{)}\PY{p}{)}
\PY{k}{else}\PY{p}{:}
    \PY{n}{topics\PYZus{}combined} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}
    
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Topics List: }\PY{l+s+si}{\PYZob{}}\PY{n}{topics\PYZus{}combined}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Topics List: Geopolitical tensions

Covid

Low economic diversification

environmental deterioration

disaster

poverty

political instability

Lack of funding

Inflation

volatile economic growth.

Gender Based Violene

low human capacity
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{11}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Map Prompt}

\PY{n}{llm} \PY{o}{=} \PY{n}{PromptLayerChatOpenAI}\PY{p}{(}\PY{n}{model}\PY{o}{=}\PY{n}{gpt\PYZus{}model}\PY{p}{,} \PY{n}{pl\PYZus{}tags}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Classifier}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{openai\PYZus{}api\PYZus{}key}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Your Key}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{map\PYZus{}template} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}\PY{l+s+s2}{Customized Prompt}
\PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}

\PY{n}{map\PYZus{}prompt} \PY{o}{=} \PY{n}{PromptTemplate}\PY{o}{.}\PY{n}{from\PYZus{}template}\PY{p}{(}\PY{n}{map\PYZus{}template}\PY{p}{)}
\PY{n}{map\PYZus{}chain} \PY{o}{=} \PY{n}{LLMChain}\PY{p}{(}\PY{n}{llm}\PY{o}{=}\PY{n}{llm}\PY{p}{,}\PY{n}{prompt}\PY{o}{=}\PY{n}{map\PYZus{}prompt}\PY{p}{)}


\PY{c+c1}{\PYZsh{} Function to extract challenges}
\PY{k}{def} \PY{n+nf}{extract\PYZus{}challenges}\PY{p}{(}\PY{n}{output}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{challenges}\PY{l+s+s1}{\PYZsq{}} \PY{o+ow}{in} \PY{n}{output}\PY{p}{:}
        \PY{k}{return} \PY{n}{output}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{challenges}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
    \PY{k}{elif} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}} \PY{o+ow}{in} \PY{n}{output}\PY{p}{:}
        \PY{n}{challenges\PYZus{}text} \PY{o}{=} \PY{n}{output}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{k}{return} \PY{n}{challenges\PYZus{}text}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{k}{return} \PY{p}{[}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Placeholder for DataFrame rows}
\PY{n}{rows} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Extracting text content from each Document}
\PY{n}{captions} \PY{o}{=} \PY{p}{[}\PY{n}{doc}\PY{o}{.}\PY{n}{page\PYZus{}content} \PY{k}{for} \PY{n}{doc} \PY{o+ow}{in} \PY{n}{doc\PYZus{}captions}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Process each caption individually}
\PY{k}{for} \PY{n}{caption} \PY{o+ow}{in} \PY{n}{captions}\PY{p}{:}
    \PY{c+c1}{\PYZsh{} Adjust this line to correctly invoke your model for a single caption and capture the output}
    \PY{n}{output} \PY{o}{=} \PY{n}{map\PYZus{}chain}\PY{o}{.}\PY{n}{invoke}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{captions}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{n}{caption}\PY{p}{\PYZcb{}}\PY{p}{)}
    
    \PY{n}{challenges} \PY{o}{=} \PY{n}{extract\PYZus{}challenges}\PY{p}{(}\PY{n}{output}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Add caption and its challenges to the rows list}
    \PY{n}{row} \PY{o}{=} \PY{p}{[}\PY{n}{caption}\PY{p}{]} \PY{o}{+} \PY{n}{challenges}
    \PY{n}{rows}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{row}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Determine the maximum number of columns needed}
\PY{n}{max\PYZus{}cols} \PY{o}{=} \PY{n+nb}{max}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{row}\PY{p}{)} \PY{k}{for} \PY{n}{row} \PY{o+ow}{in} \PY{n}{rows}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Create column headers}
\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Caption}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{+} \PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Challenge }\PY{l+s+si}{\PYZob{}}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{max\PYZus{}cols}\PY{p}{)}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Create DataFrame}
\PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{rows}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{columns}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Fill any missing values with empty strings}
\PY{n}{df}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Save the DataFrame to CSV}
\PY{n}{csv\PYZus{}filename} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2\PYZus{}15\PYZus{}challenges.csv}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{df}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{n}{csv\PYZus{}filename}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{32}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}Reduce Prompt and Chain}
\PY{c+c1}{\PYZsh{}The following prompt is for the \PYZdq{}reduce\PYZdq{} step of the algorithm. }
\PY{c+c1}{\PYZsh{} It operates against the entire set of output that is produced by the \PYZdq{}map\PYZdq{} chain.}
\PY{c+c1}{\PYZsh{}In our example, the map chain yields a set of topics that are defined on the caption it was run on. These are then grouped together and passed as a result to this reduce chain. This reduce chain is designed to take this global output of the map step and reduce it down to a final set of unique fertility topics that minimized contextual overlap.                                                                                                                                }
\PY{n}{reduce\PYZus{}template} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}\PY{l+s+s2}{Customized Prompt}
\PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}

\PY{n}{output\PYZus{}parser} \PY{o}{=} \PY{n}{CommaSeparatedListOutputParser}\PY{p}{(}\PY{p}{)}
\PY{n}{format\PYZus{}instructions} \PY{o}{=} \PY{n}{output\PYZus{}parser}\PY{o}{.}\PY{n}{get\PYZus{}format\PYZus{}instructions}\PY{p}{(}\PY{p}{)}


\PY{n}{reduce\PYZus{}prompt} \PY{o}{=} \PY{n}{PromptTemplate}\PY{p}{(}\PY{n}{template}\PY{o}{=}\PY{n}{reduce\PYZus{}template}\PY{p}{,}\PY{n}{input\PYZus{}variables}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{topics}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{partial\PYZus{}variables}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{format\PYZus{}instructions}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{format\PYZus{}instructions}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{}reduce\PYZus{}prompt = PromptTemplate.from\PYZus{}template(reduce\PYZus{}template)}
\PY{n}{reduce\PYZus{}chain}\PY{o}{=}\PY{n}{LLMChain}\PY{p}{(}\PY{n}{llm}\PY{o}{=}\PY{n}{llm}\PY{p}{,}\PY{n}{prompt}\PY{o}{=}\PY{n}{reduce\PYZus{}prompt}\PY{p}{)}

\PY{n}{combine\PYZus{}documents\PYZus{}chain} \PY{o}{=} \PY{n}{StuffDocumentsChain}\PY{p}{(}
    \PY{n}{llm\PYZus{}chain}\PY{o}{=}\PY{n}{reduce\PYZus{}chain}\PY{p}{,} \PY{n}{document\PYZus{}variable\PYZus{}name}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{topics}\PY{l+s+s2}{\PYZdq{}}
\PY{p}{)}

\PY{n}{reduce\PYZus{}documents\PYZus{}chain} \PY{o}{=} \PY{n}{ReduceDocumentsChain}\PY{p}{(}
    \PY{n}{combine\PYZus{}documents\PYZus{}chain}\PY{o}{=}\PY{n}{combine\PYZus{}documents\PYZus{}chain}\PY{p}{,}
    \PY{n}{collapse\PYZus{}documents\PYZus{}chain}\PY{o}{=}\PY{n}{combine\PYZus{}documents\PYZus{}chain}\PY{p}{,}
    \PY{n}{token\PYZus{}max}\PY{o}{=}\PY{l+m+mi}{4000}\PY{p}{)}


\PY{n}{map\PYZus{}reduce\PYZus{}chain} \PY{o}{=} \PY{n}{MapReduceDocumentsChain}\PY{p}{(}
    \PY{n}{llm\PYZus{}chain}\PY{o}{=}\PY{n}{map\PYZus{}chain}\PY{p}{,}
    \PY{n}{reduce\PYZus{}documents\PYZus{}chain}\PY{o}{=}\PY{n}{reduce\PYZus{}documents\PYZus{}chain}\PY{p}{,}
    \PY{n}{document\PYZus{}variable\PYZus{}name}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{captions}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{n}{return\PYZus{}intermediate\PYZus{}steps}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{33}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}Run Map\PYZhy{}Reduce Chain}
\PY{c+c1}{\PYZsh{}in this step we run the actual MapReduceDocumentsChain, }
\PY{c+c1}{\PYZsh{} this will then begin to process all of the captions that were read in from the CSV file and perform the}
\PY{c+c1}{\PYZsh{} \PYZdq{}map\PYZdq{} step on each of them. Once the \PYZdq{}map\PYZdq{} step is completed opn all of them it will then run the final}
\PY{c+c1}{\PYZsh{}\PYZdq{}reduce\PYZdq{} step and output a final list of topics.}

\PY{n}{output} \PY{o}{=} \PY{n}{map\PYZus{}reduce\PYZus{}chain}\PY{o}{.}\PY{n}{invoke}\PY{p}{(}\PY{n}{doc\PYZus{}captions}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{34}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Printing out the New Topics and Inspect total number of topics}
\PY{n}{text\PYZus{}to\PYZus{}parse} \PY{o}{=} \PY{n}{output}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output\PYZus{}text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Use the parsing method to split the string into a list of topics}
\PY{n}{new\PYZus{}topics} \PY{o}{=} \PY{n}{text\PYZus{}to\PYZus{}parse}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{, }\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Display the results}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Generated }\PY{l+s+si}{\PYZob{}}\PY{n+nb}{len}\PY{p}{(}\PY{n}{new\PYZus{}topics}\PY{p}{)}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{ new topics}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{k}{for} \PY{n}{topic} \PY{o+ow}{in} \PY{n}{new\PYZus{}topics}\PY{p}{:}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{topic}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Generated 39 new topics
Political Instability
Socioeconomic Challenges
Impact of External Issues
Macroeconomic Degradation
Implementation of Macroeconomic Reforms
Low Economic Growth
Effects of Climate Change
Resource Mobilization Challenges
Difficulty in Maintaining Collaborations
Security Concerns in Sahel Countries
Increased Military Spending
Low Human Development Index
High National Impact of Monetary Poverty
Urban Poverty
High State Budget Deficit
High Public Debt Rate
Access to International Financing
Uncertainty of Global Demand
Low Human Capacity
Insecurity
High Poverty Levels
Humanitarian Needs
Economic Challenges
Terrorism
Absence of a Calendar for the Electoral Process
Constitutional Changes
Financial Constraints
Risks to Development Potential
Impact of Previous Shocks
Lack of Economic Diversification
Erosion of Trade Opportunities
Investment Decisions
GDP Growth
Socioeconomic Inequality
Poverty Line
Exploitation of Development Opportunities
Availability of Policy-Relevant Data
Implementation of Impact Assessments
Application of Foresight in Policy and Regulatory Frameworks.
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{35}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}In the following step, we use a new separate chain to eliminate any new topics which are already covered or similar to topics that were read in at the start of processing.}

\PY{n}{eliminate\PYZus{}duplicates\PYZus{}template} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}\PY{l+s+s2}{Customized Prompt}

\PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}} 


\PY{n}{prompt\PYZus{}template} \PY{o}{=} \PY{n}{PromptTemplate}\PY{p}{(}\PY{n}{template}\PY{o}{=}\PY{n}{eliminate\PYZus{}duplicates\PYZus{}template}\PY{p}{,} \PY{n}{input\PYZus{}variables}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{new\PYZus{}topics}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{existing\PYZus{}topics}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{partial\PYZus{}variables}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{format\PYZus{}instructions}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{format\PYZus{}instructions}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{llm\PYZus{}chain} \PY{o}{=} \PY{n}{LLMChain}\PY{p}{(}\PY{n}{llm}\PY{o}{=}\PY{n}{llm}\PY{p}{,}\PY{n}{prompt}\PY{o}{=}\PY{n}{prompt\PYZus{}template}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{36}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Running the model to merge duplicated topics and for summary}

\PY{n}{prompt\PYZus{}template} \PY{o}{=} \PY{n}{PromptTemplate}\PY{p}{(}\PY{n}{template}\PY{o}{=}\PY{n}{eliminate\PYZus{}duplicates\PYZus{}template}\PY{p}{,} \PY{n}{input\PYZus{}variables}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{new\PYZus{}topics}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{existing\PYZus{}topics}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{partial\PYZus{}variables}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{format\PYZus{}instructions}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}\PY{n}{format\PYZus{}instructions}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{llm\PYZus{}chain} \PY{o}{=} \PY{n}{LLMChain}\PY{p}{(}\PY{n}{llm}\PY{o}{=}\PY{n}{llm}\PY{p}{,}\PY{n}{prompt}\PY{o}{=}\PY{n}{prompt\PYZus{}template}\PY{p}{)}
\PY{n}{output2} \PY{o}{=} \PY{n}{llm\PYZus{}chain}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{new\PYZus{}topics}\PY{o}{=}\PY{n}{output}\PY{p}{,}\PY{n}{existing\PYZus{}topics}\PY{o}{=}\PY{n}{topics\PYZus{}combined}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{37}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} check output }
\PY{n+nb}{print}\PY{p}{(}\PY{n}{output2}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Security Concerns in Sahel Countries, Increased Military Spending, High National
Impact of Monetary Poverty, Urban Poverty, High State Budget Deficit, High
Public Debt Rate, Access to International Financing, Uncertainty of Global
Demand, Humanitarian Needs, Economic Challenges, Terrorism, Absence of a
Calendar for the Electoral Process, Constitutional Changes, Financial
Constraints, Risks to Development Potential, Impact of Previous Shocks, Lack of
Economic Diversification, Erosion of Trade Opportunities, Investment Decisions,
GDP Growth, Socioeconomic Inequality, Poverty Line, Exploitation of Development
Opportunities, Availability of Policy-Relevant Data, Implementation of Impact
Assessments, Application of Foresight in Policy and Regulatory Frameworks.
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{38}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Print New Topics}
\PY{n}{new\PYZus{}topics} \PY{o}{=} \PY{n}{output\PYZus{}parser}\PY{o}{.}\PY{n}{parse}\PY{p}{(}\PY{n}{output2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Generated final set of }\PY{l+s+si}{\PYZob{}}\PY{n+nb}{len}\PY{p}{(}\PY{n}{new\PYZus{}topics}\PY{p}{)}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{ topics.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{new\PYZus{}topics}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Generated final set of 26 topics.
['Security Concerns in Sahel Countries', 'Increased Military Spending', 'High
National Impact of Monetary Poverty', 'Urban Poverty', 'High State Budget
Deficit', 'High Public Debt Rate', 'Access to International Financing',
'Uncertainty of Global Demand', 'Humanitarian Needs', 'Economic Challenges',
'Terrorism', 'Absence of a Calendar for the Electoral Process', 'Constitutional
Changes', 'Financial Constraints', 'Risks to Development Potential', 'Impact of
Previous Shocks', 'Lack of Economic Diversification', 'Erosion of Trade
Opportunities', 'Investment Decisions', 'GDP Growth', 'Socioeconomic
Inequality', 'Poverty Line', 'Exploitation of Development Opportunities',
'Availability of Policy-Relevant Data', 'Implementation of Impact Assessments',
'Application of Foresight in Policy and Regulatory Frameworks.']
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{39}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}need to combine the existing topics list with the new set of topics}
\PY{n}{existing\PYZus{}topics\PYZus{}lower} \PY{o}{=} \PY{p}{[}\PY{n}{item}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)} \PY{k}{for} \PY{n}{item} \PY{o+ow}{in} \PY{n}{existing\PYZus{}topics}\PY{p}{]}
\PY{n}{new\PYZus{}topics\PYZus{}lower} \PY{o}{=} \PY{p}{[}\PY{n}{item}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)} \PY{k}{for} \PY{n}{item} \PY{o+ow}{in} \PY{n}{new\PYZus{}topics}\PY{p}{]}

\PY{n}{merged\PYZus{}topics\PYZus{}list\PYZus{}lower} \PY{o}{=} \PY{n}{existing\PYZus{}topics\PYZus{}lower} \PY{o}{+} \PY{n}{new\PYZus{}topics\PYZus{}lower}
\PY{n}{unique\PYZus{}topics\PYZus{}list\PYZus{}lower} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{merged\PYZus{}topics\PYZus{}list\PYZus{}lower}\PY{p}{)}\PY{p}{)}

\PY{n}{final\PYZus{}topics\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{k}{for} \PY{n}{item} \PY{o+ow}{in} \PY{n}{unique\PYZus{}topics\PYZus{}list\PYZus{}lower}\PY{p}{:}
    \PY{k}{if} \PY{n}{item} \PY{o+ow}{in} \PY{n}{existing\PYZus{}topics\PYZus{}lower}\PY{p}{:}
        \PY{n}{final\PYZus{}topics\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{existing\PYZus{}topics}\PY{p}{[}\PY{n}{existing\PYZus{}topics\PYZus{}lower}\PY{o}{.}\PY{n}{index}\PY{p}{(}\PY{n}{item}\PY{p}{)}\PY{p}{]}\PY{p}{)}
    \PY{k}{elif} \PY{n}{item} \PY{o+ow}{in} \PY{n}{new\PYZus{}topics\PYZus{}lower}\PY{p}{:}
        \PY{n}{final\PYZus{}topics\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{new\PYZus{}topics}\PY{p}{[}\PY{n}{new\PYZus{}topics\PYZus{}lower}\PY{o}{.}\PY{n}{index}\PY{p}{(}\PY{n}{item}\PY{p}{)}\PY{p}{]}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{n}{final\PYZus{}topics\PYZus{}list}\PY{p}{)}

\PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{topics}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{final\PYZus{}topics\PYZus{}list}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{df}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{n}{topic\PYZus{}filename}\PY{p}{,}\PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
['Humanitarian Needs', 'High National Impact of Monetary Poverty', 'High State
Budget Deficit', 'Uncertainty of Global Demand', 'Covid', 'Poverty Line',
'poverty', 'Financial Constraints', ' low human capacity', 'Economic
Challenges', 'Terrorism', 'Access to International Financing', 'Risks to
Development Potential', 'disaster', 'Lack of funding', 'Availability of Policy-
Relevant Data', 'volatile economic growth.', 'Inflation', 'GDP Growth',
'Socioeconomic Inequality', 'Lack of Economic Diversification', 'Investment
Decisions', 'political instability', 'Application of Foresight in Policy and
Regulatory Frameworks.', 'environmental deterioration', 'Implementation of
Impact Assessments', 'Geopolitical tensions', 'Low economic diversification',
'Erosion of Trade Opportunities', 'Gender Based Violene', 'Exploitation of
Development Opportunities', 'High Public Debt Rate', 'Security Concerns in Sahel
Countries', 'Impact of Previous Shocks', 'Absence of a Calendar for the
Electoral Process', 'Constitutional Changes', 'Increased Military Spending',
'Urban Poverty']
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]

\end{Verbatim}
\end{tcolorbox}


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
